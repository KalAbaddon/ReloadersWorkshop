//============================================================================*
// cFirearmCOL.cs
//
// Copyright © 2013, Lobo Specialties LLC
// All Rights Reserved
//============================================================================*

//============================================================================*
// .Net Using Statements
//============================================================================*

using System;

using System.Windows.Forms;

using ReloadersWorkShop.Preferences;

//============================================================================*
// NameSpace
//============================================================================*

namespace ReloadersWorkShop
	{
	//============================================================================*
	// cFirearmCOL class
	//============================================================================*

	[Serializable]
	public class cFirearmCOL
		{
		//----------------------------------------------------------------------------*
		// Private Data Members
		//----------------------------------------------------------------------------*

		private cBullet m_Bullet = null;
		private double m_COL = 0.0;
		private double m_OgiveOAL = 0.0;

		//============================================================================*
		// cFirearmCOL() - Constructor
		//============================================================================*

		public cFirearmCOL()
			{
			}

		//============================================================================*
		// cFirearmCOL() - Copy Constructor
		//============================================================================*

		public cFirearmCOL(cFirearmCOL FirearmCOL)
			{
			m_Bullet = new cBullet(FirearmCOL.m_Bullet);
			m_COL = FirearmCOL.m_COL;
			m_OgiveOAL = FirearmCOL.m_OgiveOAL;
			}

		//============================================================================*
		// Bullet Property
		//============================================================================*

		public cBullet Bullet
			{
			get { return (m_Bullet); }
			set { m_Bullet = value; }
			}

		//============================================================================*
		// COL Property
		//============================================================================*

		public double COL
			{
			get { return (m_COL); }
			set { m_COL = value; }
			}

		//============================================================================*
		// Comparer()
		//============================================================================*

		public static int Comparer(cFirearmCOL FirearmCOL1, cFirearmCOL FirearmCOL2)
			{
			if (FirearmCOL1 == null)
				{
				if (FirearmCOL2 != null)
					return (-1);
				else
					return (0);
				}

			return (FirearmCOL1.CompareTo(FirearmCOL2));
			}

		//============================================================================*
		// CompareTo()
		//============================================================================*

		public int CompareTo(cFirearmCOL FirearmCOL)
			{
			if (FirearmCOL == null)
				return (1);

			//----------------------------------------------------------------------------*
			// Compare Bullet
			//----------------------------------------------------------------------------*

			int rc = m_Bullet.CompareTo(FirearmCOL.m_Bullet);

			//----------------------------------------------------------------------------*
			// Compare COL
			//----------------------------------------------------------------------------*

			if (rc == 0)
				{
				rc = m_COL.CompareTo(FirearmCOL.m_COL);

				//----------------------------------------------------------------------------*
				// Compare Ogive OAL
				//----------------------------------------------------------------------------*

				if (rc == 0)
					{
					rc = m_OgiveOAL.CompareTo(FirearmCOL.m_OgiveOAL);
					}
				}

			return (rc);
			}

		//============================================================================*
		// OgiveOAL Property
		//============================================================================*

		public double OgiveOAL
			{
			get { return (m_OgiveOAL); }
			set { m_OgiveOAL = value; }
			}

		//============================================================================*
		// ToString
		//============================================================================*

		public override string ToString()
			{
			string strString = String.Format("{0} - COL: {1:F3}, Ogive OAL: {2:F3}", m_Bullet.ToString(), m_COL, m_OgiveOAL);

			return (strString);
			}
		}
	}
